---
title: Week 46
engine: jupyter
categories: ['UVis']
format-links:
    - text: "Open in Google Colab"
      href: "https://colab.research.google.com/github/au-mbg/fysisk-biokemi/blob/built-notebooks/built_notebooks/student/week_46.ipynb"
      icon: box-arrow-up-right
---

```{python}
import numpy as np
```

## Extinction coefficient of human myoglobin

The protein of human myoglobin is given below

```{python}
sequence = """GLSDGEWQLVLNVWGKVEADIPGHGQEVLIRLFKGHPETLEKFDKFKHLKSEDEMKASEDLKKHGA
TVLTALGGILKKKGHHEAEIKPLAQSHATKHKIPVKYLEFISECIIQVLQSKHPGDFGADAQGAMNKALELFRKDMASNY
KELGFQG"""
```

We want to calculate the *extinction coefficient* of this protein, we have seen that 
this can be calculated using the formula

$$
\epsilon(280 \mathrm{nm}) = N_{Trp} A + N_{Tyr} B + N_{Cys} C 
$$ {#eq-extinction}

Where $N_{Trp}$ is the number of Tryptophan in the protein (and likewise for the other two terms), and the three constants $A$, $B$ and $C$ are given as 

$$
\begin{align}
A &= 5500 \ \mathrm{M^{−1} cm^{−1}} \\
B &= 1490 \ \mathrm{M^{−1} cm^{−1}} \\
C &= 125 \ \mathrm{M^{−1} cm^{−1}}
\end{align}
$$

In order to calculate the formula we need to know the count of the relevant residues, 
we can use Python to get that - for example we can count the number of Tryptophan like so; 
```{python}
N_trp = sequence.count("W")
```

#### (a) Determine the number of residues

In the cell below find the number of residues

```{python}
#| solution: true
N_tyr = sequence.count("Y")
N_cys = sequence.count("C")
```

```{python}
#| exercise: true
#| eval: false
N_tyr = ... # Your code here
... # Your code here for the N_cys.
```

```{python}
print(f"{N_trp = }")
print(f"{N_tyr = }")
print(f"{N_cys = }")
```

#### (b) Calculate the extinction coefficient 

Use equation (@eq-extinction) to calculate the extinction coefficient of human myoglobin.

```{python}
A = 5500
B = 1490
C = 125
```

```{python}
#| exercise: true
#| eval: false
epsilon = ... # Erstat ... med din kode.
print(epsilon)
```

```{python}
#| solution: true
epsilon = A * N_trp + B * N_tyr + C*N_cys
print(epsilon)
```
What are the units of this value? 

#### (c) Compare residue count to ProtParam 

ProtParam is an online tool that calculates various physical and chemical
parameters from a given protein sequence and is used worldwide in research laboratories.

![Protpram tool input page.](https://raw.githubusercontent.com/au-mbg/fysisk-biokemi/refs/heads/main/lessons/figures/week_46/protpram_input.png){.lightbox}

Go to ProtPram at this link: [https://web.expasy.org/protparam/](https://web.expasy.org/protparam/) and paste the 
sequence and click **Compute Parameters**. You should then see the calculated parameters, similar 
to in the image below 

![Protpram tool calculated properties.](https://raw.githubusercontent.com/au-mbg/fysisk-biokemi/refs/heads/main/lessons/figures/week_46/protpram_output.png){.lightbox}

On the output page you will see the number of residues, does that match your calculation? 

#### (d) ProtPram extinction coefficient

Scrolling further down you will find that ProtParam also gives the extinction coefficient for the protein. As the absorbance of Cys residues varies slightly dependent on whether disulfide bridges (cystines) are present or not, ProtParam list the extinction coefficient in both reduced and oxidized states of the Cys residues.

Consider the following questions

- Why are the extinction coefficients of myoglobin the same whether cystines are formed or not?

- Does the extinction coefficient computed in ProtParam match the value you have calculated?

#### (e) Calculate the absorbance

Using the extinction coefficient and the molecular weight given by ProtParam, calculate the absorbance at 280 nm of a myoglobin solution at a concentration of 1 mg/mL in a cuvette with a light path of 1 cm.

```{python}
#| solution: true
molecular_weight = 17052.61 
path_length = 1 # cm 
concentration = 1 # mg/mL
```

```{python}
#| exercise: true
#| eval: false
molecular_weight = ... # Find the value on ProtPram (It has units of g/mol)
path_length = ... # Set the value of the path length
concentration = ... # Set the value of the concentraiton.
```

Remember to convert the concentration to $\mathrm{mol/L}$.

```{python}
#| exercise: true
#| eval: false
A280 = ...
print(A280)
```

```{python}
#| solution: true
A280 = concentration / molecular_weight * path_length * epsilon
print(A280)
```

This value is what is known as the A280(0.1%) of a protein, i.e. the absorbance of a given protein at a concentration of 0.1% weight/volume (= 1 g/L = 1 mg/mL). 

#### (f) Compare the absorbance to Protpram

Does the number reported by ProtParam correspond to the number you just calculated in (e)?

## Average properties of amino acids and proteins. 

In the accompanying Excel file (`AA_frequency.xlsx`), you will find a tablet that contains the molecular weight of the 20 common amino acid residues, i.e. their weight as residues in a peptide chain. Additionally, you will find their relative frequency in E. coli proteins, where a frequency of 0.01 means that this residue constitutes 1 % of the residues in a protein. 

#### (a) Load the data file.

Use the widget below to load the `AA_frequency.xlsx` file.

```{python}
#| eval: true
from IPython.display import display 
from fysisk_biokemi.widgets import DataUploader
uploader = DataUploader()
uploader.display()
```
```{python}
#| eval: false
df = uploader.get_dataframe()
display(df)
```

```{python}
#| solution: true
from IPython.display import display 
from fysisk_biokemi.datasets import load_dataset
df = load_dataset('AA_frequency')
display(df)
```

#### (b)	Average molecular weight 

Calculate the average molecular weight of a residue in a protein?

::: {.callout-tip}

You can use `np.sum` to sum all values in an array.

::: 

```{python}
#| exercise: true
#| eval: false
average_mw = ...
print(f"{average_mw = :3.3f}")
```

```{python}
#| solution: true
average_mw = np.sum(df['MW of AA residue'] * df['Frequency in proteins'])
print(f"{average_mw = :3.3f}")
```

#### (c)	Weight of 300-residue protein 

What would the molecular weight of a 300-residue protein most likely be, if you did not know its sequence?

```{python}
#| exercise: true
#| eval: false
mw_300 = ...
print(f"{mw_300 = :3.3f}")
```

```{python}
#| solution: true
mw_300 = average_mw * 300
print(f"{mw_300 = :3.3f}")
```


--- 

In many proteins, you will be working with a mixture of proteins. This could for example be a cell lysate or a biological fluid for protein abundance analysis, or the early stages of a protein purification process. In these situations, you cannot work with a molecule specific extinction coefficient. Instead, we would use the average values, which we will determine below.

---

#### (d)	Average concentration of residues 

Calculate the average concentration of amino acid residues in a protein mixture at 1 mg/mL.

```{python}
#| exercise: true
#| eval: false
c_residue_avg = ...
print(f"{c_residue_avg = :3.3f} M")
```

```{python}
#| solution: true
c_residue_avg = 1 / average_mw
print(f"{c_residue_avg = :3.3f} M")
```

#### (e)	Absorbance 

Calculate the absorbance from such a mixture under the assumption that only Trp and Tyr contribute.

```{python}
#| exercise: true
#| eval: false
freq = df.set_index("Name")["Frequency in proteins"]
f_trp = freq["Tryptophan (Trp/W)"]
f_tyr = freq["Tyrosine (Tyr/Y)"]
c_trp = ... # Erstat med din kode.
c_tyr = ... # Erstat med din kode.

print(f"{c_trp = :3.5f}")
print(f"{c_tyr = :3.5f}")
```

```{python}
#| solution: true
freq = df.set_index("Name")["Frequency in proteins"]
f_trp = freq["Tryptophan (Trp/W)"]
f_tyr = freq["Tyrosine (Tyr/Y)"]

c_trp = c_residue_avg * f_trp
c_tyr = c_residue_avg * f_tyr
print(f"{c_trp = :3.5f}")
print(f"{c_tyr = :3.5f}")
```
```{python}
#| exercise: true
#| eval: false
A280 = ... # Erstat med din kode.
print(f"{A280 = :3.3f}")
```

```{python}
#| solution: true
L = 1 # Path length
A280 = L * (5500 * c_trp + 1490 * c_tyr)
print(f"{A280 = :3.3f}")
```

#### (f)	Adsorbance $\rightarrow$ concentration 

For a cell lysate, you measure and absorbance of 0.78 at a path length of 0.5 cm. What is the protein concentration?

```{python}
#| exercise: true
#| eval: false

# Set known values:
A = 0.78 # Unitless
l = 0.5 # cm

# Extract frequencies
freq = df.set_index("Name")["Frequency in proteins"]
f_trp = freq["Tryptophan (Trp/W)"]
f_tyr = freq["Tyrosine (Tyr/Y)"]

# Calculate extintinction coefficent in [L/(mol cm)]
eps_mix = ...
# Calculate molar concentration [mol/L]
c_res = ...
# Calculate concentration [g/L] = [mg/mL]:
conc_mg_per_mL = ...
print(f"Protein concentration = {conc_mg_per_mL:.3f} mg/mL")
```

```{python}
#| solution: true

# Set known values:
A = 0.78 # Unitless
l = 0.5 # cm

# Extract frequencies
freq = df.set_index("Name")["Frequency in proteins"]
f_trp = freq["Tryptophan (Trp/W)"]
f_tyr = freq["Tyrosine (Tyr/Y)"]

# Calculate extintinction coefficent in [L/(mol cm)]
eps_mix = 5500 * f_trp + 1490 * f_tyr
# Calculate molar concentration
c_res = A / (l * eps_mix) # [mol/L]
# Calculate concentration:
conc_mg_per_mL = c_res * average_mw # [g/mol] = [mg/mL] because mw is [g/mol]
print(f"Protein concentration = {conc_mg_per_mL:.3f} mg/mL")
```
